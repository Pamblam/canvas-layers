<!DOCTYPE html>
<html>
	<head>
		<title>Test...</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<style>
			canvas{
				border: 1px solid black;
			}
		</style>
	</head>
	<body>
		<canvas id="canvas"></canvas>
		<script src="../src/CanvasTextStyle.js"></script>
		<script src="../src/CanvasTextBody.js"></script>
		<script src="../src/CanvasTextChar.js"></script>
		<script>
			//------------------------------------------------------------------
			//-- Config options ------------------------------------------------
			//------------------------------------------------------------------
			
			var boundary_width = 750;
			var boundary_height = 500;
			var text_spacing = -3;
			var line_spacing = 5;
			var font = '50px Apple Chancery';
			var text = 'Two driven jocks help fax my big quiz. The jay, pig, fox, zebra and my wolves quack! Sympathizing would fix Quaker objectives. A wizard\'s job is to vex chumps quickly in fog.';
			
			//------------------------------------------------------------------
			//-- Setup Canvas --------------------------------------------------
			//------------------------------------------------------------------
			
			var canvas = document.getElementById('canvas');
			var ctx = canvas.getContext('2d');
			canvas.width = boundary_width;
			canvas.height = boundary_height;
			
			var textStyle = new CanvasTextStyle({
				font: font,
				fill_style: 'black',
				text_align: 'left',
				base_line: 'top'
			});
			
			textStyle.setContext(ctx);
			
			//------------------------------------------------------------------
			//-- Calculate coordinates of characters ---------------------------
			//------------------------------------------------------------------
			
			function generateTextBody(ctx, text, boundary_width, text_spacing, line_spacing){
				
				var textBody = new CanvasTextBody(ctx, {
					line_spacing,
					text_spacing,
					boundary_width
				});
				
				// Array of characters in the text
				var characters = text.split('');
				
				for(var i=0; i<characters.length; i++){
					textBody.appendChar(characters[i]);
				}
				
				return textBody;
			}
			
			
			//------------------------------------------------------------------
			// --- Print Text on canvas ----------------------------------------
			//------------------------------------------------------------------
			
			var textBody = generateTextBody(ctx, text, boundary_width, text_spacing, line_spacing);
			
			console.log(textBody.chars[0]);
			
			for(let i=0; i<textBody.chars.length; i++){
				let char = textBody.chars[i];
				ctx.fillText(char.char, char.x, char.y);
				
				
				
				ctx.save();
				ctx.beginPath();
				ctx.strokeStyle = 'blue';
				let x = char.x - char.bounding_left;
				let y = char.y - char.ascent;
				ctx.rect(x, y, char.width, char.height);
				ctx.stroke();
				ctx.restore();
			}
			
//			var text_lines = generateCanvasTextLines(ctx, text, boundary_width, text_spacing, line_spacing);
//			for(let i=0; i<text_lines.length; i++){
//				let chars = text_lines[i].getChars(ctx);
//				for(let n=0; n<chars.length; n++){
//					let char = chars[n];
//					
//					ctx.fillText(char.char, char.x, char.y);
//					
////					ctx.save();
////					ctx.beginPath();
////					ctx.strokeStyle = 'blue';
////					let {x, y, width, height} = char.getBoundingBox();
////					ctx.rect(x, y, width, height);
////					ctx.stroke();
////					ctx.restore();
//				}
//			}
			

		</script>
	</body>
</html>
